# WP Rig AI Instructions

> Machine-readable guidance for AI coding agents working with WP Rig.

## Quick Reference

| Feature | Primary File(s) |
|---------|-----------------|
| Theme initialization | `functions.php`, `inc/Theme.php` |
| Header styles | `assets/css/src/_header.css` |
| Navigation menu | `inc/Nav_Menus/Component.php`, `assets/css/src/_navigation.css`, `assets/js/src/navigation.ts` |
| Typography | `assets/css/src/_typography.css` |
| CSS variables | `assets/css/src/_custom-properties.css` |
| Accessibility | `inc/Accessibility/Component.php`, `assets/css/src/_accessibility.css` |
| Sidebar/widgets | `inc/Sidebars/Component.php`, `assets/css/src/sidebar.css`, `assets/css/src/widgets.css` |
| Comments | `inc/Comments/Component.php`, `assets/css/src/comments.css` |
| Editor styles | `inc/Editor/Component.php`, `assets/css/src/editor/editor-styles.css` |
| Custom logo | `inc/Custom_Logo/Component.php` |
| Custom header | `inc/Custom_Header/Component.php` |
| Fonts | `inc/Fonts/Component.php` |
| Build configuration | `config/config.default.json`, `config/config.json` |

## File Mappings by Category

### Styles (CSS)

Source files are in `assets/css/src/` and processed by `build-css.js`.

| File | Purpose |
|------|---------|
| `global.css` | Main entry point - imports all partials |
| `_custom-properties.css` | CSS custom properties (variables) |
| `_custom-media.css` | Custom media query breakpoints |
| `_reset.css` | CSS reset/normalize |
| `_typography.css` | Font styles, headings, text |
| `_elements.css` | Base HTML element styles |
| `_links.css` | Link styles and states |
| `_header.css` | Site header styles |
| `_navigation.css` | Navigation menu styles |
| `_footer.css` | Site footer styles |
| `_forms.css` | Form element styles |
| `_media.css` | Images, video, embeds |
| `_blocks.css` | WordPress block styles |
| `_accessibility.css` | Screen reader and a11y styles |
| `_utility.css` | Utility/helper classes |
| `content.css` | Post/page content styles (conditional) |
| `sidebar.css` | Sidebar styles (conditional) |
| `widgets.css` | Widget styles |
| `comments.css` | Comment section styles (conditional) |
| `front-page.css` | Front page specific styles |
| `editor/editor-styles.css` | Block editor styles |
| `admin/theme-settings.css` | Admin settings page styles |

### PHP Components

Located in `inc/` - each feature is a Component class implementing `Component_Interface`.

| Component | File | Responsibility |
|-----------|------|----------------|
| Theme | `inc/Theme.php` | Main class - registers and initializes all components |
| Localization | `inc/Localization/Component.php` | Text domain, translations |
| Base_Support | `inc/Base_Support/Component.php` | Core theme support features |
| Editor | `inc/Editor/Component.php` | Block editor integration |
| Accessibility | `inc/Accessibility/Component.php` | Accessibility enhancements |
| Image_Sizes | `inc/Image_Sizes/Component.php` | Custom image sizes |
| PWA | `inc/PWA/Component.php` | Progressive Web App support |
| Comments | `inc/Comments/Component.php` | Comment functionality |
| Nav_Menus | `inc/Nav_Menus/Component.php` | Navigation menu registration |
| Sidebars | `inc/Sidebars/Component.php` | Widget area registration |
| Custom_Background | `inc/Custom_Background/Component.php` | Custom background support |
| Custom_Header | `inc/Custom_Header/Component.php` | Custom header support |
| Custom_Logo | `inc/Custom_Logo/Component.php` | Custom logo support |
| Post_Thumbnails | `inc/Post_Thumbnails/Component.php` | Featured image support |
| EZ_Customizer | `inc/EZ_Customizer/Component.php` | Customizer settings |
| Fonts | `inc/Fonts/Component.php` | Web font loading |
| Styles | `inc/Styles/Component.php` | CSS enqueueing and preloading |
| Scripts | `inc/Scripts/Component.php` | JavaScript enqueueing |
| Excerpts | `inc/Excerpts/Component.php` | Excerpt customization |
| Options | `inc/Options/Component.php` | Theme options page |

### JavaScript / TypeScript

Source files are in `assets/js/src/` and processed by `build-js.js`.

| File | Purpose |
|------|---------|
| `global.ts` | Global scripts loaded on all pages |
| `navigation.ts` | Mobile menu toggle, dropdown behavior |
| `customizer.tsx` | Customizer live preview |
| `admin/index.jsx` | Admin settings React app |
| `admin/api.js` | REST API helpers for admin |

### Templates

| File | Purpose |
|------|---------|
| `index.php` | Main template fallback |
| `header.php` | Site header (opens HTML, head, body) |
| `footer.php` | Site footer (closes body, HTML) |
| `sidebar.php` | Sidebar template |
| `comments.php` | Comments template |
| `404.php` | Not found page |
| `500.php` | Server error page |
| `offline.php` | PWA offline page |
| `template-parts/` | Reusable template partials |

### Configuration

| File | Purpose |
|------|---------|
| `config/config.default.json` | Default theme settings (do not edit) |
| `config/config.json` | Custom theme settings (version controlled) |
| `config/config.local.json` | Local-only settings (gitignored) |
| `package.json` | npm scripts and dependencies |
| `composer.json` | PHP dependencies |

## Common Tasks

### Change the header styles

1. Edit `assets/css/src/_header.css`
2. Run `npm run dev` to rebuild and watch
3. Header styles are imported via `global.css`

### Add a new navigation menu location

1. Edit `inc/Nav_Menus/Component.php`
2. Add to the array in `register_nav_menus()` method
3. Use `wp_nav_menu(['theme_location' => 'your-location'])` in templates

### Modify how stylesheets are loaded

1. Edit `inc/Styles/Component.php`
2. See `action_enqueue_styles()` for main enqueueing
3. See `action_preload_styles()` for preload hints
4. Conditional styles are in `get_css_files()` method

### Modify how scripts are loaded

1. Edit `inc/Scripts/Component.php`
2. See `action_enqueue_scripts()` method
3. Scripts use async loading by default

### Add a new CSS partial

1. Create `assets/css/src/_yourfile.css`
2. Import it in `assets/css/src/global.css` with `@import "_yourfile.css";`
3. Run `npm run dev` to rebuild

### Add a new PHP component

1. Create `inc/Your_Feature/Component.php`
2. Implement `Component_Interface` (see existing components)
3. Register in `inc/Theme.php` in `get_default_components()`

### Change theme configuration

1. Copy settings from `config/config.default.json`
2. Override in `config/config.json` (only include changed values)
3. For local-only settings, use `config/config.local.json`

### Build for production

1. Run `npm run bundle`
2. Production theme is generated in `wp-content/themes/{slug}/`

## Build System

| Command | Purpose |
|---------|---------|
| `npm run rig-init` | Install dependencies (first time setup) |
| `npm run dev` | Build and watch for changes |
| `npm run build` | Build without watching |
| `npm run bundle` | Create production-ready theme |
| `npm run lint` | Run all linters |

## Coding Conventions

- **CSS partials**: Prefixed with underscore (`_header.css`)
- **PHP components**: Located at `inc/{Feature}/Component.php`
- **PHP namespace**: `WP_Rig\WP_Rig`
- **Text domain**: Matches theme slug in config
- **Conditional styles**: Loaded only on pages that need them (see `Styles/Component.php`)
